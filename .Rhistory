ggplot(test2)+
geom_sf()
test2 <- st_intersection(test, countries %>% filter(name_long == "Papua New Guinea")) %>%
st_cast("POLYGON")%>%
mutate(area = st_area(geometry()))
mutate(area = st_area(geometry)
test2 <- st_intersection(test, countries %>% filter(name_long == "Papua New Guinea")) %>%
st_cast("POLYGON")%>%
mutate(area = st_area(geometry))
View(test2)
test2 <- st_intersection(test, countries %>% filter(name_long == "Papua New Guinea")) %>%
st_cast("POLYGON")%>%
mutate(area = st_area(geometry))%>%
## biggest area is main island, not part of archipelago
filter(area != max(area))
ggplot(test2)+
geom_sf()
View(test2)
result <- st_intersection(provinces, countries %>% filter(name_long == "Papua New Guinea")) %>%
st_cast("POLYGON")%>%
mutate(area = st_area(geometry))%>%
## biggest area is main island, not part of archipelago
filter(area != max(area))%>%
mutate(name = "Bismarck Archipelago")%>%
dplyr::select(name)
provinces <- osmquery$osm_multipolygons %>%
summarize(geometry = st_union(geometry))
result <- st_intersection(provinces, countries %>% filter(name_long == "Papua New Guinea")) %>%
st_cast("POLYGON")%>%
mutate(area = st_area(geometry))%>%
## biggest area is main island, not part of archipelago
filter(area != max(area))%>%
mutate(name = "Bismarck Archipelago")%>%
dplyr::select(name)
View(result)
View(result)
highres <- ne_countries()
highres <- ne_countries(returnclass = "sf")
View(highres)
?ne_countries
highres <- ne_countries(returnclass = "sf", scale = "large", country = "Carolines")
highres <- ne_countries(returnclass = "sf", scale = "large", continent = "Oceania")
View(highres)
highres <- ne_countries(returnclass = "sf", scale = "large", continent = "Oceania")%>%
filter(name %in% c("Micronesia", "Palau"))
ggplot(highres)+
geom_sf()
View(countries)
found_today <- ne_countries(returnclass = "sf", scale = "medium") %>%
filter(grepl("Mariana|Palau|Marshall|Nauru|Samoa|Solomon|Micronesia", admin))%>%
filter(admin != "American Samoa")
View(found_today)
View(data)
osmquery <- opq_osm_id(c(2269792,272632), type = "relation")%>%
osmdata_sf()
osmquery$osm_multipolygons %>%
mutate(name = "Welserland")%>%
group_by(name)%>%
summarize(geometry = st_union(geometry))
library(needs)
needs(tidyverse,
sf,
ggplot2,
rnaturalearth,
osmdata)
countries <- ne_countries(returnclass = "sf", scale = "medium") %>%
dplyr::select(name_long)
fn <- "current_borders.geojson"
if(file.exists(fn)){
file.remove(fn)
}
write_sf(countries, fn)
# borders_1900 <- st_read("https://raw.githubusercontent.com/aourednik/historical-basemaps/master/geojson/world_1900.geojson")
borders_1914 <- st_read("https://raw.githubusercontent.com/aourednik/historical-basemaps/master/geojson/world_1914.geojson")
# borders_1700 <- st_read("https://raw.githubusercontent.com/aourednik/historical-basemaps/master/geojson/world_1700.geojson")
## 1914
found_1914 <- borders_1914 %>%
filter(grepl("Togoland|German.*Africa|Kamerun", NAME))
colonies <- found_1914 %>%
dplyr::select(name = NAME)
found_today <- ne_countries(returnclass = "sf", scale = "medium") %>%
filter(grepl("Mariana|Palau|Marshall|Nauru|Samoa|Solomon|Micronesia", admin))%>%
filter(admin != "American Samoa")
## Samoa is what used to be Western Samoa (German colony), American Samoa was colonized by US
## Mariana Islands are Northern Mariana Islands (German colony), Southern islands are Guam (US colony)
colonies <- colonies %>%
bind_rows(found_today %>%
dplyr::select(name = admin))
## open street map
## brandenburg gold coast
osmquery <- opq_osm_id(c(240909315,216464672), type = "way")%>%
osmdata_sf()
colonies <- colonies %>%
bind_rows(osmquery$osm_polygons %>%
mutate(name = "Brandenburg Gold Coast")%>%
group_by(name)%>%
summarize(geometry = st_union(geometry)))
## st thomas
osmquery <- opq_osm_id(2754159, type = "relation")%>%
osmdata_sf()
colonies <- colonies %>%
bind_rows(osmquery$osm_multipolygons %>%
mutate(name = "St. Thomas")%>%
dplyr::select(name))
## arguin
osmquery <- opq_osm_id(4109731, type = "way")%>%
osmdata_sf()
colonies <- colonies %>%
bind_rows(osmquery$osm_polygons %>%
mutate(name = "Arguin")%>%
dplyr::select(name))
## bismarck archipelago
osmquery <- opq_osm_id(c(3777382, 3777383, 3777381, 3777384, 311780, 311779, 311778), type = "relation")%>%
osmdata_sf()
provinces <- osmquery$osm_multipolygons %>%
summarize(geometry = st_union(geometry))
result <- st_intersection(provinces, countries %>% filter(name_long == "Papua New Guinea")) %>%
st_cast("POLYGON")%>%
mutate(area = st_area(geometry))%>%
## biggest area is main island, not part of archipelago
filter(area != max(area))%>%
mutate(name = "Bismarck Archipelago")%>%
dplyr::select(name)
colonies <- colonies %>%
bind_rows(result)
# ## to do (manually?)
# ## German concession in Tianjin
# https://en.wikipedia.org/wiki/Foreign_concessions_in_Tianjin
## Jiaozhou Bay
# https://en.wikipedia.org/wiki/Kiautschou_Bay_Leased_Territory
## Wituland
# https://en.wikipedia.org/wiki/Wituland
## Kaiser Wilhelmsland
# https://de.wikipedia.org/wiki/Kaiser-Wilhelms-Land
## welserland
# https://de.wikipedia.org/wiki/Klein-Venedig_(Venezuela)
## finalize / add info
data <- read_csv("input/colonies_details.csv")
missing <- data %>%
anti_join(
colonies %>%
mutate(name = str_replace_all(name,
c("German E\\. Africa \\(Tanganyika\\)" = "German East Africa",
"Northern Mariana Islands" = "Mariana Islands",
"Federated States of Micronesia" = "Caroline Islands",
"Solomon Islands" = "North Solomon Islands")))
)
final <- colonies %>%
mutate(name = str_replace_all(name,
c("German E\\. Africa \\(Tanganyika\\)" = "German East Africa",
"Northern Mariana Islands" = "Mariana Islands",
"Federated States of Micronesia" = "Caroline Islands",
"Solomon Islands" = "North Solomon Islands")))%>%
left_join(data)
fn <-  "test_colonies.geojson"
if(file.exists(fn)){
file.remove(fn)
}
write_sf(final, fn)
getwd()
View(final)
View(result)
result <- st_intersection(provinces, countries %>% filter(name_long == "Papua New Guinea")) %>%
st_cast("POLYGON")%>%
mutate(area = st_area(geometry))%>%
## biggest area is main island, not part of archipelago
filter(area != max(area))%>%
summarize(geometry = st_union(geometry))%>%
mutate(name = "Bismarck Archipelago")
View(result)
library(needs)
needs(tidyverse,
sf,
ggplot2,
rnaturalearth,
osmdata)
countries <- ne_countries(returnclass = "sf", scale = "medium") %>%
dplyr::select(name_long)
fn <- "current_borders.geojson"
if(file.exists(fn)){
file.remove(fn)
}
write_sf(countries, fn)
# borders_1900 <- st_read("https://raw.githubusercontent.com/aourednik/historical-basemaps/master/geojson/world_1900.geojson")
borders_1914 <- st_read("https://raw.githubusercontent.com/aourednik/historical-basemaps/master/geojson/world_1914.geojson")
# borders_1700 <- st_read("https://raw.githubusercontent.com/aourednik/historical-basemaps/master/geojson/world_1700.geojson")
## 1914
found_1914 <- borders_1914 %>%
filter(grepl("Togoland|German.*Africa|Kamerun", NAME))
colonies <- found_1914 %>%
dplyr::select(name = NAME)
found_today <- ne_countries(returnclass = "sf", scale = "medium") %>%
filter(grepl("Mariana|Palau|Marshall|Nauru|Samoa|Solomon|Micronesia", admin))%>%
filter(admin != "American Samoa")
## Samoa is what used to be Western Samoa (German colony), American Samoa was colonized by US
## Mariana Islands are Northern Mariana Islands (German colony), Southern islands are Guam (US colony)
colonies <- colonies %>%
bind_rows(found_today %>%
dplyr::select(name = admin))
## open street map
## brandenburg gold coast
osmquery <- opq_osm_id(c(240909315,216464672), type = "way")%>%
osmdata_sf()
colonies <- colonies %>%
bind_rows(osmquery$osm_polygons %>%
mutate(name = "Brandenburg Gold Coast")%>%
group_by(name)%>%
summarize(geometry = st_union(geometry)))
## st thomas
osmquery <- opq_osm_id(2754159, type = "relation")%>%
osmdata_sf()
colonies <- colonies %>%
bind_rows(osmquery$osm_multipolygons %>%
mutate(name = "St. Thomas")%>%
dplyr::select(name))
## arguin
osmquery <- opq_osm_id(4109731, type = "way")%>%
osmdata_sf()
colonies <- colonies %>%
bind_rows(osmquery$osm_polygons %>%
mutate(name = "Arguin")%>%
dplyr::select(name))
## bismarck archipelago
osmquery <- opq_osm_id(c(3777382, 3777383, 3777381, 3777384, 311780, 311779, 311778), type = "relation")%>%
osmdata_sf()
provinces <- osmquery$osm_multipolygons %>%
summarize(geometry = st_union(geometry))
result <- st_intersection(provinces, countries %>% filter(name_long == "Papua New Guinea")) %>%
st_cast("POLYGON")%>%
mutate(area = st_area(geometry))%>%
## biggest area is main island, not part of archipelago
filter(area != max(area))%>%
summarize(geometry = st_union(geometry))%>%
mutate(name = "Bismarck Archipelago")
colonies <- colonies %>%
bind_rows(result)
# ## to do (manually?)
# ## German concession in Tianjin
# https://en.wikipedia.org/wiki/Foreign_concessions_in_Tianjin
## Jiaozhou Bay
# https://en.wikipedia.org/wiki/Kiautschou_Bay_Leased_Territory
## Wituland
# https://en.wikipedia.org/wiki/Wituland
## Kaiser Wilhelmsland
# https://de.wikipedia.org/wiki/Kaiser-Wilhelms-Land
## welserland
# https://de.wikipedia.org/wiki/Klein-Venedig_(Venezuela)
## finalize / add info
data <- read_csv("input/colonies_details.csv")
missing <- data %>%
anti_join(
colonies %>%
mutate(name = str_replace_all(name,
c("German E\\. Africa \\(Tanganyika\\)" = "German East Africa",
"Northern Mariana Islands" = "Mariana Islands",
"Federated States of Micronesia" = "Caroline Islands",
"Solomon Islands" = "North Solomon Islands")))
)
final <- colonies %>%
mutate(name = str_replace_all(name,
c("German E\\. Africa \\(Tanganyika\\)" = "German East Africa",
"Northern Mariana Islands" = "Mariana Islands",
"Federated States of Micronesia" = "Caroline Islands",
"Solomon Islands" = "North Solomon Islands")))%>%
left_join(data)
fn <-  "test_colonies.geojson"
if(file.exists(fn)){
file.remove(fn)
}
write_sf(final, fn)
library(needs)
needs(tidyverse,
sf,
ggplot2,
rnaturalearth,
osmdata)
countries <- ne_countries(returnclass = "sf", scale = "medium") %>%
dplyr::select(name_long)
fn <- "current_borders.geojson"
if(file.exists(fn)){
file.remove(fn)
}
write_sf(countries, fn)
# borders_1900 <- st_read("https://raw.githubusercontent.com/aourednik/historical-basemaps/master/geojson/world_1900.geojson")
borders_1914 <- st_read("https://raw.githubusercontent.com/aourednik/historical-basemaps/master/geojson/world_1914.geojson")
# borders_1700 <- st_read("https://raw.githubusercontent.com/aourednik/historical-basemaps/master/geojson/world_1700.geojson")
## 1914
found_1914 <- borders_1914 %>%
filter(grepl("Togoland|German.*Africa|Kamerun", NAME))
colonies <- found_1914 %>%
dplyr::select(name = NAME)
found_today <- ne_countries(returnclass = "sf", scale = "medium") %>%
filter(grepl("Mariana|Palau|Marshall|Nauru|Samoa|Solomon|Micronesia", admin))%>%
filter(admin != "American Samoa")
## Samoa is what used to be Western Samoa (German colony), American Samoa was colonized by US
## Mariana Islands are Northern Mariana Islands (German colony), Southern islands are Guam (US colony)
colonies <- colonies %>%
bind_rows(found_today %>%
dplyr::select(name = admin))
fn <-  "test_colonies.geojson"
if(file.exists(fn)){
file.remove(fn)
}
write_sf(final, fn)
colonies
osmquery <- opq_osm_id(c(240909315,216464672), type = "way")%>%
osmdata_sf()
osmquery$osm_polygons %>%
mutate(name = "Brandenburg Gold Coast")%>%
group_by(name)%>%
summarize(geometry = st_union(geometry))
countries <- ne_countries(returnclass = "sf", scale = "medium") %>%
dplyr::select(name_long)
fn <- "current_borders.geojson"
if(file.exists(fn)){
file.remove(fn)
}
write_sf(countries, fn)
# borders_1900 <- st_read("https://raw.githubusercontent.com/aourednik/historical-basemaps/master/geojson/world_1900.geojson")
borders_1914 <- st_read("https://raw.githubusercontent.com/aourednik/historical-basemaps/master/geojson/world_1914.geojson")
# borders_1700 <- st_read("https://raw.githubusercontent.com/aourednik/historical-basemaps/master/geojson/world_1700.geojson")
## 1914
found_1914 <- borders_1914 %>%
filter(grepl("Togoland|German.*Africa|Kamerun", NAME))
colonies <- found_1914 %>%
dplyr::select(name = NAME)
found_today <- ne_countries(returnclass = "sf", scale = "medium") %>%
filter(grepl("Mariana|Palau|Marshall|Nauru|Samoa|Solomon|Micronesia", admin))%>%
filter(admin != "American Samoa")
## Samoa is what used to be Western Samoa (German colony), American Samoa was colonized by US
## Mariana Islands are Northern Mariana Islands (German colony), Southern islands are Guam (US colony)
colonies <- colonies %>%
bind_rows(found_today %>%
dplyr::select(name = admin))
View(colonies)
osmquery <- opq_osm_id(c(240909315,216464672), type = "way")%>%
osmdata_sf()
# ## brandenburg gold coast - makes problems
#
osmquery <- opq_osm_id(c(240909315,216464672), type = "way")%>%
osmdata_sf()
crs(osmquery$osm_polygons) == crs(colonies)
crs(found_1914) == crs(found_today)
crs(found_1914)
crs(found_today)
## 1914
found_1914 <- borders_1914 %>%
filter(grepl("Togoland|German.*Africa|Kamerun", NAME))%>%
st_transform(4326)
colonies <- found_1914 %>%
dplyr::select(name = NAME)
found_today <- ne_countries(returnclass = "sf", scale = "medium") %>%
filter(grepl("Mariana|Palau|Marshall|Nauru|Samoa|Solomon|Micronesia", admin))%>%
filter(admin != "American Samoa")%>%
st_transform(4326)
colonies <- colonies %>%
bind_rows(found_today %>%
dplyr::select(name = admin))
osmquery <- opq_osm_id(c(240909315,216464672), type = "way")%>%
osmdata_sf()
colonies <- colonies %>%
bind_rows(osmquery$osm_polygons %>%
mutate(name = "Brandenburg Gold Coast")%>%
group_by(name)%>%
summarize(geometry = st_union(geometry))%>%
st_transform(4326))
## finalize / add info
data <- read_csv("input/colonies_details.csv")
missing <- data %>%
anti_join(
colonies %>%
mutate(name = str_replace_all(name,
c("German E\\. Africa \\(Tanganyika\\)" = "German East Africa",
"Northern Mariana Islands" = "Mariana Islands",
"Federated States of Micronesia" = "Caroline Islands",
"Solomon Islands" = "North Solomon Islands")))
)
final <- colonies %>%
mutate(name = str_replace_all(name,
c("German E\\. Africa \\(Tanganyika\\)" = "German East Africa",
"Northern Mariana Islands" = "Mariana Islands",
"Federated States of Micronesia" = "Caroline Islands",
"Solomon Islands" = "North Solomon Islands")))%>%
left_join(data)
fn <-  "test_colonies.geojson"
if(file.exists(fn)){
file.remove(fn)
}
write_sf(final, fn)
View(countries)
View(colonies)
ggplot(colonies)+
geom_sf(aes(fill = name))
write_sf(colonies, "test.shp")
?write_sf
st_drivers()
write_sf(colonies, "test.topo.json")
write_sf(colonies, "test.topojson")
library(needs)
needs(tidyverse,
sf,
ggplot2,
rnaturalearth,
osmdata)
countries <- ne_countries(returnclass = "sf", scale = "medium") %>%
dplyr::select(name_long)
fn <- "current_borders.geojson"
if(file.exists(fn)){
file.remove(fn)
}
write_sf(countries, fn)
# borders_1900 <- st_read("https://raw.githubusercontent.com/aourednik/historical-basemaps/master/geojson/world_1900.geojson")
borders_1914 <- st_read("https://raw.githubusercontent.com/aourednik/historical-basemaps/master/geojson/world_1914.geojson")
# borders_1700 <- st_read("https://raw.githubusercontent.com/aourednik/historical-basemaps/master/geojson/world_1700.geojson")
## 1914
found_1914 <- borders_1914 %>%
filter(grepl("Togoland|German.*Africa|Kamerun", NAME))%>%
st_transform(4326)
colonies <- found_1914 %>%
dplyr::select(name = NAME)
found_today <- ne_countries(returnclass = "sf", scale = "medium") %>%
filter(grepl("Mariana|Palau|Marshall|Nauru|Samoa|Solomon|Micronesia", admin))%>%
filter(admin != "American Samoa")%>%
st_transform(4326)
## Samoa is what used to be Western Samoa (German colony), American Samoa was colonized by US
## Mariana Islands are Northern Mariana Islands (German colony), Southern islands are Guam (US colony)
colonies <- colonies %>%
bind_rows(found_today %>%
dplyr::select(name = admin))
## open street map
# ## brandenburg gold coast - makes problems
#
# osmquery <- opq_osm_id(c(240909315,216464672), type = "way")%>%
#   osmdata_sf()
#
# colonies <- colonies %>%
#   bind_rows(osmquery$osm_polygons %>%
#               mutate(name = "Brandenburg Gold Coast")%>%
#               group_by(name)%>%
#               summarize(geometry = st_union(geometry))%>%
#               st_transform(4326))
# ## st thomas - makes problems
#
# osmquery <- opq_osm_id(2754159, type = "relation")%>%
#   osmdata_sf()
#
# colonies <- colonies %>%
#   bind_rows(osmquery$osm_multipolygons %>%
#               mutate(name = "St. Thomas")%>%
#               dplyr::select(name))
# ## arguin - makes problems
#
# osmquery <- opq_osm_id(4109731, type = "way")%>%
#   osmdata_sf()
#
# colonies <- colonies %>%
#   bind_rows(osmquery$osm_polygons %>%
#     mutate(name = "Arguin")%>%
#       dplyr::select(name))
# ## bismarck archipelago - makes problems
#
# osmquery <- opq_osm_id(c(3777382, 3777383, 3777381, 3777384, 311780, 311779, 311778), type = "relation")%>%
#   osmdata_sf()
#
# provinces <- osmquery$osm_multipolygons %>%
#   summarize(geometry = st_union(geometry))
#
# result <- st_intersection(provinces, countries %>% filter(name_long == "Papua New Guinea")) %>%
#   st_cast("POLYGON")%>%
#   mutate(area = st_area(geometry))%>%
#   ## biggest area is main island, not part of archipelago
#   filter(area != max(area))%>%
#   summarize(geometry = st_union(geometry))%>%
#   mutate(name = "Bismarck Archipelago")
#
# colonies <- colonies %>%
#   bind_rows(result)
# ## to do (manually?)
# ## German concession in Tianjin
# https://en.wikipedia.org/wiki/Foreign_concessions_in_Tianjin
## Jiaozhou Bay
# https://en.wikipedia.org/wiki/Kiautschou_Bay_Leased_Territory
## Wituland
# https://en.wikipedia.org/wiki/Wituland
## Kaiser Wilhelmsland
# https://de.wikipedia.org/wiki/Kaiser-Wilhelms-Land
## welserland
# https://de.wikipedia.org/wiki/Klein-Venedig_(Venezuela)
## finalize / add info
data <- read_csv("input/colonies_details.csv")
missing <- data %>%
anti_join(
colonies %>%
mutate(name = str_replace_all(name,
c("German E\\. Africa \\(Tanganyika\\)" = "German East Africa",
"Northern Mariana Islands" = "Mariana Islands",
"Federated States of Micronesia" = "Caroline Islands",
"Solomon Islands" = "North Solomon Islands")))
)
final <- colonies %>%
mutate(name = str_replace_all(name,
c("German E\\. Africa \\(Tanganyika\\)" = "German East Africa",
"Northern Mariana Islands" = "Mariana Islands",
"Federated States of Micronesia" = "Caroline Islands",
"Solomon Islands" = "North Solomon Islands")))%>%
left_join(data)
fn <-  "test_colonies.geojson"
if(file.exists(fn)){
file.remove(fn)
}
write_sf(final, fn)
View(colonies)
